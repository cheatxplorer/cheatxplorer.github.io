<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Discord Webhook Tool</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <style>
    body {
      background-color: #36393f;
      color: #dcddde;
      font-family: 'Whitney', 'Helvetica Neue', Helvetica, Arial, sans-serif;
    }
    .discord-embed {
      background-color: #2f3136;
      border-left: 4px solid #5865F2;
      border-radius: 4px;
      padding: 8px 16px;
      margin-bottom: 16px;
    }
    .button-primary {
      background-color: #5865F2;
      color: white;
      transition: all 0.2s ease;
    }
    .button-primary:hover {
      background-color: #4752c4;
      transform: translateY(-2px);
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    .button-primary:active {
      transform: translateY(0);
      box-shadow: none;
    }
    .button-secondary {
      background-color: #4f545c;
      color: white;
      transition: all 0.2s ease;
    }
    .button-secondary:hover {
      background-color: #43474e;
      transform: translateY(-2px);
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    .button-secondary:active {
      transform: translateY(0);
      box-shadow: none;
    }
    .button-success {
      background-color: #43b581;
      color: white;
      transition: all 0.2s ease;
    }
    .button-success:hover {
      background-color: #3ca374;
      transform: translateY(-2px);
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    .button-success:active {
      transform: translateY(0);
      box-shadow: none;
    }
    .button-danger {
      background-color: #f04747;
      color: white;
      transition: all 0.2s ease;
    }
    .button-danger:hover {
      background-color: #dc3d3d;
      transform: translateY(-2px);
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    .button-danger:active {
      transform: translateY(0);
      box-shadow: none;
    }
    .button-link {
      background-color: #4f545c;
      color: white;
      transition: all 0.2s ease;
    }
    .button-link:hover {
      background-color: #43474e;
      transform: translateY(-2px);
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    .button-link:active {
      transform: translateY(0);
      box-shadow: none;
    }
    .webhook-button {
      margin-right: 8px;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 500;
      border: none;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    .webhook-button:disabled {
      opacity: 0.7;
      cursor: not-allowed;
      transform: none !important;
      box-shadow: none !important;
    }
    .webhook-button i {
      margin-right: 6px;
    }
    .form-input {
      background-color: #40444b;
      color: #dcddde;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      width: 100%;
      margin-bottom: 16px;
      transition: all 0.2s ease;
    }
    .form-input:focus {
      outline: none;
      box-shadow: 0 0 0 2px rgba(88, 101, 242, 0.5);
    }
    .avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin-right: 16px;
    }
    .embed-author {
      display: flex;
      align-items: center;
      margin-bottom: 8px;
    }
    .embed-author-icon {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      margin-right: 8px;
    }
    .embed-image {
      max-width: 100%;
      max-height: 300px;
      border-radius: 4px;
      margin-top: 16px;
    }
    .embed-thumbnail {
      width: 80px;
      height: 80px;
      border-radius: 4px;
      float: right;
      margin-left: 16px;
    }
    .embed-footer {
      display: flex;
      align-items: center;
      margin-top: 8px;
      font-size: 0.85em;
      color: #72767d;
    }
    .embed-footer-icon {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      margin-right: 8px;
    }
    .embed-fields {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 8px;
      margin-top: 8px;
    }
    .embed-field {
      margin-bottom: 8px;
    }
    .embed-field-name {
      font-weight: bold;
      margin-bottom: 4px;
    }
    .tab {
      cursor: pointer;
      padding: 10px 16px;
      border-radius: 4px 4px 0 0;
      background-color: #2f3136;
      margin-right: 4px;
      transition: background-color 0.2s;
    }
    .tab:hover {
      background-color: #36393f;
    }
    .tab.active {
      background-color: #40444b;
    }
    .tab-content {
      display: none;
      background-color: #40444b;
      padding: 16px;
      border-radius: 0 4px 4px 4px;
      margin-bottom: 16px;
    }
    .tab-content.active {
      display: block;
    }
    .toast-container {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 9999;
    }
    .toast {
      max-width: 350px;
      padding: 12px 16px;
      border-radius: 5px;
      margin-bottom: 10px;
      animation: slideIn 0.2s ease, fadeOut 0.5s ease 2.5s forwards;
      display: flex;
      align-items: center;
    }
    .toast.success {
      background-color: #43b581;
      color: white;
    }
    .toast.error {
      background-color: #f04747;
      color: white;
    }
    .toast.info {
      background-color: #5865F2;
      color: white;
    }
    .toast-icon {
      margin-right: 10px;
      font-size: 1.2em;
    }
    .toast-message {
      flex: 1;
    }
    .toast-close {
      cursor: pointer;
      opacity: 0.6;
      transition: opacity 0.2s;
    }
    .toast-close:hover {
      opacity: 1;
    }
    @keyframes slideIn {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }
    @keyframes fadeOut {
      from {
        opacity: 1;
      }
      to {
        opacity: 0;
        display: none;
      }
    }
    .timestamp-badge {
      display: inline-block;
      padding: 4px 8px;
      background-color: #2c2f33;
      border-radius: 4px;
      margin-top: 5px;
      font-size: 0.8em;
    }
    .copy-webhook {
      cursor: pointer;
      color: #5865F2;
      margin-left: 8px;
      transition: color 0.2s;
    }
    .copy-webhook:hover {
      color: #4752c4;
    }
    .loading-spinner {
      display: inline-block;
      width: 16px;
      height: 16px;
      border: 2px solid rgba(255,255,255,0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s ease-in-out infinite;
      margin-right: 8px;
    }
    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }
  </style>
</head>
<body class="min-h-screen">
  <div class="container mx-auto p-4">
    <header class="mb-8">
      <h1 class="text-2xl font-bold text-white">Discord Webhook Tool</h1>
      <p class="text-gray-400">Create and send custom Discord webhook messages</p>
    </header>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
      <!-- Editor Panel -->
      <div class="bg-gray-800 p-4 rounded-lg">
        <h2 class="text-xl font-semibold mb-4">Message Editor</h2>
        
        <!-- Webhook URL -->
        <div class="mb-4">
          <label class="block mb-2 flex justify-between">
            <span>Webhook URL</span>
            <span class="copy-webhook text-xs hidden" id="paste-webhook">
              <i class="fas fa-clipboard"></i> Paste from clipboard
            </span>
          </label>
          <input type="text" id="webhook-url" class="form-input" placeholder="https://discord.com/api/webhooks/...">
        </div>
        
        <!-- Profile -->
        <div class="mb-4">
          <label class="block mb-2">Username</label>
          <input type="text" id="username" class="form-input" placeholder="Webhook Username">
          
          <label class="block mb-2 mt-4">Avatar URL</label>
          <input type="text" id="avatar-url" class="form-input" placeholder="https://example.com/avatar.png">
        </div>
        
        <!-- Message Content -->
        <div class="mb-4">
          <label class="block mb-2">Message</label>
          <textarea id="content" class="form-input h-32" placeholder="Enter your message content here..."></textarea>
        </div>
        
        <!-- Embed Editor Tabs -->
        <div class="mb-4">
          <div class="flex mb-0 flex-wrap">
            <div class="tab active" data-tab="basic">Basic</div>
            <div class="tab" data-tab="author">Author</div>
            <div class="tab" data-tab="images">Images</div>
            <div class="tab" data-tab="footer">Footer</div>
            <div class="tab" data-tab="fields">Fields</div>
          </div>
          
          <!-- Basic Tab -->
          <div class="tab-content active" id="basic-tab">
            <label class="block mb-2">Embed Title</label>
            <input type="text" id="embed-title" class="form-input" placeholder="Embed Title">
            
            <label class="block mb-2">Embed URL</label>
            <input type="text" id="embed-url" class="form-input" placeholder="https://example.com">
            
            <label class="block mb-2">Embed Description</label>
            <textarea id="embed-description" class="form-input h-24" placeholder="Enter embed description..."></textarea>
            
            <label class="block mb-2">Embed Color</label>
            <input type="color" id="embed-color" class="bg-transparent h-10" value="#5865F2">
            
            <label class="block mb-2 mt-4">Timestamp</label>
            <div class="flex">
              <button id="current-timestamp" class="webhook-button button-secondary mr-2">
                <i class="fas fa-clock"></i> Current Time
              </button>
              <button id="clear-timestamp" class="webhook-button button-danger">
                <i class="fas fa-times"></i> Clear
              </button>
            </div>
            <div id="timestamp-display" class="timestamp-badge hidden mt-2">
              <i class="fas fa-clock"></i> <span id="timestamp-text"></span>
            </div>
          </div>
          
          <!-- Author Tab -->
          <div class="tab-content" id="author-tab">
            <label class="block mb-2">Author Name</label>
            <input type="text" id="author-name" class="form-input" placeholder="Author Name">
            
            <label class="block mb-2">Author URL</label>
            <input type="text" id="author-url" class="form-input" placeholder="https://example.com">
            
            <label class="block mb-2">Author Icon URL</label>
            <input type="text" id="author-icon" class="form-input" placeholder="https://example.com/icon.png">
          </div>
          
          <!-- Images Tab -->
          <div class="tab-content" id="images-tab">
            <label class="block mb-2">Image URL</label>
            <input type="text" id="image-url" class="form-input" placeholder="https://example.com/image.png">
            
            <label class="block mb-2">Thumbnail URL</label>
            <input type="text" id="thumbnail-url" class="form-input" placeholder="https://example.com/thumbnail.png">
          </div>
          
          <!-- Footer Tab -->
          <div class="tab-content" id="footer-tab">
            <label class="block mb-2">Footer Text</label>
            <input type="text" id="footer-text" class="form-input" placeholder="Footer Text">
            
            <label class="block mb-2">Footer Icon URL</label>
            <input type="text" id="footer-icon" class="form-input" placeholder="https://example.com/footer-icon.png">
          </div>
          
          <!-- Fields Tab -->
          <div class="tab-content" id="fields-tab">
            <div id="fields-container">
              <!-- Fields will be added here -->
            </div>
            
            <button id="add-field" class="webhook-button button-primary mt-4">
              <i class="fas fa-plus"></i> Add Field
            </button>
          </div>
        </div>
        
        <!-- Buttons -->
        <div class="flex mt-8 flex-wrap">
          <button id="send-button" class="webhook-button button-success mr-4 mb-2">
            <i class="fas fa-paper-plane"></i> Send Message
          </button>
          <button id="clear-button" class="webhook-button button-danger mb-2">
            <i class="fas fa-trash"></i> Clear All
          </button>
        </div>
      </div>

      <!-- Preview Panel -->
      <div class="bg-gray-800 p-4 rounded-lg">
        <h2 class="text-xl font-semibold mb-4">Message Preview</h2>
        
        <div id="preview-container" class="bg-gray-700 p-4 rounded-lg">
          <!-- Message Preview -->
          <div id="message-preview" class="mb-4">
            <div class="flex items-start">
              <img id="preview-avatar" class="avatar" src="https://cdn.discordapp.com/embed/avatars/0.png" alt="Avatar">
              <div>
                <div id="preview-username" class="font-semibold text-white">Webhook Username</div>
                <div id="preview-content" class="text-gray-300 mt-1"></div>
              </div>
            </div>
          </div>
          
          <!-- Embed Preview -->
          <div id="embed-preview" class="discord-embed mt-4 hidden">
            <!-- Author -->
            <div id="preview-author" class="embed-author hidden">
              <img id="preview-author-icon" class="embed-author-icon" src="" alt="">
              <a id="preview-author-name" href="#" target="_blank"></a>
            </div>
            
            <!-- Title -->
            <div id="preview-embed-title-container">
              <a id="preview-embed-title" href="#" target="_blank" class="font-bold"></a>
            </div>
            
            <!-- Description -->
            <div id="preview-embed-description" class="mt-2"></div>
            
            <!-- Fields -->
            <div id="preview-fields" class="embed-fields"></div>
            
            <!-- Image -->
            <div id="preview-image-container" class="hidden">
              <img id="preview-image" class="embed-image" src="" alt="">
            </div>
            
            <!-- Thumbnail -->
            <div id="preview-thumbnail-container" class="hidden">
              <img id="preview-thumbnail" class="embed-thumbnail" src="" alt="">
            </div>
            
            <!-- Footer -->
            <div id="preview-footer" class="embed-footer hidden">
              <img id="preview-footer-icon" class="embed-footer-icon hidden" src="" alt="">
              <span id="preview-footer-text"></span>
              <span id="preview-timestamp" class="ml-1"></span>
            </div>
          </div>
        </div>
        
        <div class="mt-4 text-sm text-gray-400">
          <p>⚠️ Note: On GitHub Pages, this tool can only send webhook messages; it cannot save webhooks. Enter your webhook URL each time you use the tool.</p>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Toast Container -->
  <div id="toast-container" class="toast-container"></div>

  <script>
    // Default values
    const DEFAULT_AVATAR = "https://cdn.discordapp.com/embed/avatars/0.png";
    const DEFAULT_USERNAME = "WebhookTool.py";
    
    // Elements
    const webhookUrlInput = document.getElementById('webhook-url');
    const pasteWebhookBtn = document.getElementById('paste-webhook');
    const usernameInput = document.getElementById('username');
    const avatarUrlInput = document.getElementById('avatar-url');
    const contentInput = document.getElementById('content');
    
    // Embed elements
    const embedTitleInput = document.getElementById('embed-title');
    const embedUrlInput = document.getElementById('embed-url');
    const embedDescriptionInput = document.getElementById('embed-description');
    const embedColorInput = document.getElementById('embed-color');
    const currentTimestampBtn = document.getElementById('current-timestamp');
    const clearTimestampBtn = document.getElementById('clear-timestamp');
    const timestampDisplay = document.getElementById('timestamp-display');
    const timestampText = document.getElementById('timestamp-text');
    
    // Author elements
    const authorNameInput = document.getElementById('author-name');
    const authorUrlInput = document.getElementById('author-url');
    const authorIconInput = document.getElementById('author-icon');
    
    // Image elements
    const imageUrlInput = document.getElementById('image-url');
    const thumbnailUrlInput = document.getElementById('thumbnail-url');
    
    // Footer elements
    const footerTextInput = document.getElementById('footer-text');
    const footerIconInput = document.getElementById('footer-icon');
    
    // Fields elements
    const fieldsContainer = document.getElementById('fields-container');
    const addFieldBtn = document.getElementById('add-field');
    
    // Buttons
    const sendButton = document.getElementById('send-button');
    const clearButton = document.getElementById('clear-button');
    
    // Preview elements
    const previewUsername = document.getElementById('preview-username');
    const previewAvatar = document.getElementById('preview-avatar');
    const previewContent = document.getElementById('preview-content');
    const embedPreview = document.getElementById('embed-preview');
    const previewEmbedTitle = document.getElementById('preview-embed-title');
    const previewEmbedDescription = document.getElementById('preview-embed-description');
    const previewAuthor = document.getElementById('preview-author');
    const previewAuthorName = document.getElementById('preview-author-name');
    const previewAuthorIcon = document.getElementById('preview-author-icon');
    const previewImageContainer = document.getElementById('preview-image-container');
    const previewImage = document.getElementById('preview-image');
    const previewThumbnailContainer = document.getElementById('preview-thumbnail-container');
    const previewThumbnail = document.getElementById('preview-thumbnail');
    const previewFooter = document.getElementById('preview-footer');
    const previewFooterText = document.getElementById('preview-footer-text');
    const previewFooterIcon = document.getElementById('preview-footer-icon');
    const previewTimestamp = document.getElementById('preview-timestamp');
    const previewFields = document.getElementById('preview-fields');
    
    // Toast container
    const toastContainer = document.getElementById('toast-container');
    
    // State
    let timestamp = null;
    let fields = [];
    
    // Check if clipboard API is available
    if (navigator.clipboard) {
      pasteWebhookBtn.classList.remove('hidden');
      pasteWebhookBtn.addEventListener('click', async () => {
        try {
          const text = await navigator.clipboard.readText();
          if (text.includes('discord.com/api/webhooks/')) {
            webhookUrlInput.value = text;
            showToast('success', 'Webhook URL pasted from clipboard');
          } else {
            showToast('error', 'Clipboard content is not a valid webhook URL');
          }
        } catch (err) {
          showToast('error', 'Could not read from clipboard: ' + err.message);
        }
      });
    }
    
    // Initialize with default values
    usernameInput.value = DEFAULT_USERNAME;
    avatarUrlInput.value = DEFAULT_AVATAR;
    updatePreview();
    
    // Tab navigation
    const tabs = document.querySelectorAll('.tab');
    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        // Remove active class from all tabs and tab contents
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        
        // Add active class to clicked tab
        tab.classList.add('active');
        
        // Add active class to corresponding tab content
        const tabName = tab.getAttribute('data-tab');
        document.getElementById(`${tabName}-tab`).classList.add('active');
      });
    });
    
    // Event listeners for inputs
    usernameInput.addEventListener('input', updatePreview);
    avatarUrlInput.addEventListener('input', updatePreview);
    contentInput.addEventListener('input', updatePreview);
    embedTitleInput.addEventListener('input', updatePreview);
    embedUrlInput.addEventListener('input', updatePreview);
    embedDescriptionInput.addEventListener('input', updatePreview);
    embedColorInput.addEventListener('input', updatePreview);
    authorNameInput.addEventListener('input', updatePreview);
    authorUrlInput.addEventListener('input', updatePreview);
    authorIconInput.addEventListener('input', updatePreview);
    imageUrlInput.addEventListener('input', updatePreview);
    thumbnailUrlInput.addEventListener('input', updatePreview);
    footerTextInput.addEventListener('input', updatePreview);
    footerIconInput.addEventListener('input', updatePreview);
    
    // Timestamp buttons
    currentTimestampBtn.addEventListener('click', () => {
      timestamp = new Date().toISOString();
      timestampDisplay.classList.remove('hidden');
      timestampText.textContent = new Date().toLocaleString();
      showToast('info', 'Current timestamp added');
      updatePreview();
    });
    
    clearTimestampBtn.addEventListener('click', () => {
      timestamp = null;
      timestampDisplay.classList.add('hidden');
      showToast('info', 'Timestamp cleared');
      updatePreview();
    });
    
    // Add field button
    addFieldBtn.addEventListener('click', addField);
    
    // Send and clear buttons
    sendButton.addEventListener('click', sendMessage);
    clearButton.addEventListener('click', clearAll);
    
    // Create and show toast
    function showToast(type, message) {
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      
      let icon = 'info-circle';
      if (type === 'success') icon = 'check-circle';
      if (type === 'error') icon = 'exclamation-circle';
      
      toast.innerHTML = `
        <div class="toast-icon">
          <i class="fas fa-${icon}"></i>
        </div>
        <div class="toast-message">${message}</div>
        <div class="toast-close">
          <i class="fas fa-times"></i>
        </div>
      `;
      
      toastContainer.appendChild(toast);
      
      // Remove toast after animation
      setTimeout(() => {
        toast.remove();
      }, 3000);
      
      // Close button
      const closeBtn = toast.querySelector('.toast-close');
      closeBtn.addEventListener('click', () => {
        toast.remove();
      });
    }
    
    // Add a new field
    function addField() {
      const fieldId = fields.length;
      const fieldDiv = document.createElement('div');
      fieldDiv.className = 'field-container mb-4 p-3 bg-gray-900 rounded';
      fieldDiv.innerHTML = `
        <div class="flex justify-between mb-2">
          <label class="font-semibold">Field ${fieldId + 1}</label>
          <button class="remove-field text-xs text-red-400" data-id="${fieldId}">
            <i class="fas fa-trash"></i> Remove
          </button>
        </div>
        <input type="text" class="field-name form-input" data-id="${fieldId}" placeholder="Field Name">
        <textarea class="field-value form-input mt-2" data-id="${fieldId}" placeholder="Field Value"></textarea>
        <div class="mt-2">
          <label class="inline-flex items-center">
            <input type="checkbox" class="field-inline form-checkbox bg-gray-700 border-gray-600" data-id="${fieldId}">
            <span class="ml-2">Inline</span>
          </label>
        </div>
      `;
      
      fieldsContainer.appendChild(fieldDiv);
      
      // Add new field to fields array
      fields.push({
        name: '',
        value: '',
        inline: false
      });
      
      showToast('success', 'Field added');
      
      // Add event listeners for new field
      const nameInput = fieldDiv.querySelector(`.field-name[data-id="${fieldId}"]`);
      const valueInput = fieldDiv.querySelector(`.field-value[data-id="${fieldId}"]`);
      const inlineCheckbox = fieldDiv.querySelector(`.field-inline[data-id="${fieldId}"]`);
      const removeButton = fieldDiv.querySelector(`.remove-field[data-id="${fieldId}"]`);
      
      nameInput.addEventListener('input', (e) => {
        fields[fieldId].name = e.target.value;
        updatePreview();
      });
      
      valueInput.addEventListener('input', (e) => {
        fields[fieldId].value = e.target.value;
        updatePreview();
      });
      
      inlineCheckbox.addEventListener('change', (e) => {
        fields[fieldId].inline = e.target.checked;
        updatePreview();
      });
      
      removeButton.addEventListener('click', () => {
        // Remove field from fields array
        fields.splice(fieldId, 1);
        
        // Remove field from DOM
        fieldDiv.remove();
        
        // Update other field IDs
        document.querySelectorAll('.field-container').forEach((container, index) => {
          container.querySelector('label').textContent = `Field ${index + 1}`;
        });
        
        showToast('info', 'Field removed');
        updatePreview();
      });
    }
    
    // Update preview
    function updatePreview() {
      // Update username and avatar
      previewUsername.textContent = usernameInput.value || DEFAULT_USERNAME;
      previewAvatar.src = avatarUrlInput.value || DEFAULT_AVATAR;
      
      // Update content
      previewContent.textContent = contentInput.value;
      
      // Show/hide embed based on if there's any embed content
      const hasEmbedContent = embedTitleInput.value || 
                              embedDescriptionInput.value || 
                              authorNameInput.value || 
                              imageUrlInput.value || 
                              thumbnailUrlInput.value || 
                              footerTextInput.value || 
                              fields.length > 0;
      
      if (hasEmbedContent) {
        embedPreview.style.display = 'block';
        embedPreview.style.borderLeftColor = embedColorInput.value;
      } else {
        embedPreview.style.display = 'none';
      }
      
      // Update embed title
      if (embedTitleInput.value) {
        previewEmbedTitle.textContent = embedTitleInput.value;
        previewEmbedTitle.style.display = 'inline';
        
        if (embedUrlInput.value) {
          previewEmbedTitle.href = embedUrlInput.value;
        } else {
          previewEmbedTitle.removeAttribute('href');
        }
      } else {
        previewEmbedTitle.style.display = 'none';
      }
      
      // Update embed description
      previewEmbedDescription.textContent = embedDescriptionInput.value;
      
      // Update author
      if (authorNameInput.value) {
        previewAuthor.style.display = 'flex';
        previewAuthorName.textContent = authorNameInput.value;
        
        if (authorUrlInput.value) {
          previewAuthorName.href = authorUrlInput.value;
        } else {
          previewAuthorName.removeAttribute('href');
        }
        
        if (authorIconInput.value) {
          previewAuthorIcon.src = authorIconInput.value;
          previewAuthorIcon.style.display = 'inline';
        } else {
          previewAuthorIcon.style.display = 'none';
        }
      } else {
        previewAuthor.style.display = 'none';
      }
      
      // Update image
      if (imageUrlInput.value) {
        previewImageContainer.style.display = 'block';
        previewImage.src = imageUrlInput.value;
      } else {
        previewImageContainer.style.display = 'none';
      }
      
      // Update thumbnail
      if (thumbnailUrlInput.value) {
        previewThumbnailContainer.style.display = 'block';
        previewThumbnail.src = thumbnailUrlInput.value;
      } else {
        previewThumbnailContainer.style.display = 'none';
      }
      
      // Update footer
      if (footerTextInput.value || timestamp) {
        previewFooter.style.display = 'flex';
        previewFooterText.textContent = footerTextInput.value;
        
        if (footerIconInput.value) {
          previewFooterIcon.src = footerIconInput.value;
          previewFooterIcon.style.display = 'inline';
        } else {
          previewFooterIcon.style.display = 'none';
        }
        
        if (timestamp) {
          const date = new Date(timestamp);
          previewTimestamp.textContent = date.toLocaleString();
        } else {
          previewTimestamp.textContent = '';
        }
      } else {
        previewFooter.style.display = 'none';
      }
      
      // Update fields
      previewFields.innerHTML = '';
      
      if (fields.length > 0) {
        fields.forEach(field => {
          if (field.name && field.value) {
            const fieldDiv = document.createElement('div');
            fieldDiv.className = `embed-field ${field.inline ? 'inline' : 'block'}`;
            
            const fieldName = document.createElement('div');
            fieldName.className = 'embed-field-name';
            fieldName.textContent = field.name;
            
            const fieldValue = document.createElement('div');
            fieldValue.className = 'embed-field-value';
            fieldValue.textContent = field.value;
            
            fieldDiv.appendChild(fieldName);
            fieldDiv.appendChild(fieldValue);
            previewFields.appendChild(fieldDiv);
          }
        });
      }
    }
    
    // Send webhook message
    async function sendMessage() {
      const webhookUrl = webhookUrlInput.value;
      if (!webhookUrl) {
        showToast('error', 'Please enter a webhook URL');
        return;
      }
      
      const message = {
        content: contentInput.value,
        username: usernameInput.value || DEFAULT_USERNAME,
        avatar_url: avatarUrlInput.value || DEFAULT_AVATAR
      };
      
      // Add embed if there's any embed content
      const hasEmbedContent = embedTitleInput.value || 
                            embedDescriptionInput.value || 
                            authorNameInput.value || 
                            imageUrlInput.value || 
                            thumbnailUrlInput.value || 
                            footerTextInput.value || 
                            fields.length > 0;
      
      if (hasEmbedContent) {
        const embed = {};
        
        if (embedTitleInput.value) embed.title = embedTitleInput.value;
        if (embedUrlInput.value) embed.url = embedUrlInput.value;
        if (embedDescriptionInput.value) embed.description = embedDescriptionInput.value;
        if (embedColorInput.value) embed.color = parseInt(embedColorInput.value.replace('#', ''), 16);
        if (timestamp) embed.timestamp = timestamp;
        
        if (authorNameInput.value) {
          embed.author = {
            name: authorNameInput.value
          };
          
          if (authorUrlInput.value) embed.author.url = authorUrlInput.value;
          if (authorIconInput.value) embed.author.icon_url = authorIconInput.value;
        }
        
        if (imageUrlInput.value) {
          embed.image = {
            url: imageUrlInput.value
          };
        }
        
        if (thumbnailUrlInput.value) {
          embed.thumbnail = {
            url: thumbnailUrlInput.value
          };
        }
        
        if (footerTextInput.value) {
          embed.footer = {
            text: footerTextInput.value
          };
          
          if (footerIconInput.value) embed.footer.icon_url = footerIconInput.value;
        }
        
        if (fields.length > 0) {
          const validFields = fields.filter(field => field.name && field.value);
          if (validFields.length > 0) {
            embed.fields = validFields;
          }
        }
        
        message.embeds = [embed];
      }
      
      try {
        // Show loading spinner
        sendButton.innerHTML = '<div class="loading-spinner"></div> Sending...';
        sendButton.disabled = true;
        
        const response = await fetch(webhookUrl, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(message)
        });
        
        if (!response.ok) {
          throw new Error(`${response.status} ${response.statusText}`);
        }
        
        showToast('success', 'Message sent successfully!');
      } catch (error) {
        showToast('error', `Failed to send message: ${error.message}`);
      } finally {
        // Restore button
        sendButton.innerHTML = '<i class="fas fa-paper-plane"></i> Send Message';
        sendButton.disabled = false;
      }
    }
    
    // Clear all fields
    function clearAll() {
      // Clear message inputs
      contentInput.value = '';
      
      // Clear embed inputs
      embedTitleInput.value = '';
      embedUrlInput.value = '';
      embedDescriptionInput.value = '';
      embedColorInput.value = '#5865F2';
      
      // Clear author inputs
      authorNameInput.value = '';
      authorUrlInput.value = '';
      authorIconInput.value = '';
      
      // Clear image inputs
      imageUrlInput.value = '';
      thumbnailUrlInput.value = '';
      
      // Clear footer inputs
      footerTextInput.value = '';
      footerIconInput.value = '';
      
      // Clear timestamp
      timestamp = null;
      timestampDisplay.classList.add('hidden');
      
      // Clear fields
      fields = [];
      fieldsContainer.innerHTML = '';
      
      // Update preview
      updatePreview();
      
      showToast('info', 'All fields cleared');
    }
  </script>
</body>
</html>
